% TCM: TOTEM Communication Middleware
% Copyright: Copyright (C) 2009-2012
% Contact: denis.conan@telecom-sudparis.eu, michel.simatic@telecom-sudparis.eu
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.3
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
% A copy of the license is included in the section entitled "GNU
% Free Documentation License".


\subsection{Python idioms for the game logic server}
\label{SS_api_python}

This section details only the idioms for the game logic server. The protocol 
of the game logic server specified in the TOTEM library is
complemented by the list of actions specified in the listings~\ref{L-listofactions}, \ref{L-firstactionkind}, and \ref{L-secondactionkind}.

\begin{lstlisting}[float=htbp,frame=bt,basicstyle=\scriptsize\sffamily,numbers=left,
   numberstyle=\tiny, stepnumber=1,
    numbersep=5pt,language=python,label=L-listofactions,caption=List of action kinds of the state machine for the game logic server]
MyListOfActions = ListOfActionsEnumeration("MyListOfActions",
    [("myFirstActionKind", MyFirstActionKind),
     ("mySecondActionKind", MySecondActionKind)
     ])
\end{lstlisting}

\begin{lstlisting}[float=htbp,frame=bt,basicstyle=\scriptsize\sffamily,numbers=left,
   numberstyle=\tiny, stepnumber=1,
    numbersep=5pt,language=python,label=L-firstactionkind,caption=Game logic server's actions of the first action kinds]
def doNothing(state, header, body):
    pass

MyFirstActionKind = GameLogicActionEnumeration("myFirstActionKind", 100, 0, 1000,
    [("myFirstAction", myFirstAction),
     ("mySecondAction", mySecondAction),
     ("myThirdAction",doNothing)
     ])
\end{lstlisting}

\begin{lstlisting}[float=htbp,frame=bt,basicstyle=\scriptsize\sffamily,numbers=left,
   numberstyle=\tiny, stepnumber=1,
    numbersep=5pt,language=python,label=L-secondactionkind,caption=Game logic server's actions of the second action kinds]
def doNothing(state, header, body):
    pass

MySecondActionKind = GameLogicActionEnumeration("mySecondActionKind", 101, 0, 1000,
    [("myFourthAction", myFourthAction),
     ("myFitfhAction", myFitfhAction)
     ])
\end{lstlisting}


\subsubsection{Game logic server state}

The game logic server's state is defined in the TOTEM library and can be
extended by client applications. All the attributes presented in
Listing~\ref{L-gamelogicserverstate} are public.

\begin{lstlisting}[float=htbp,frame=bt,basicstyle=\scriptsize\sffamily,numbers=left,
   numberstyle=\tiny, stepnumber=1,
    numbersep=5pt,language=python,label=L-gamelogicserverstate,caption=Game logic server's state]
class MyState(GameLogicState):
    mynewstatevariable = None
class GameLogicState(object):
    createGameInstanceSemaphore = None
    vhost = None
    connection = None
    channel = None
    gamelogiclistofactions = None
    gameName = None
    instanceName = None
\end{lstlisting}


\subsubsection{Game logic server's protocol of the state machine}

In Listing~\ref{L-gamelogicserverprotocol}, the protocol of the state
machine for the game logic server is specified as methods with three
arguments: the state of the game logic server, the header of the
message received and the content of the message.

\begin{lstlisting}[float=htbp,frame=bt,basicstyle=\scriptsize\sffamily,numbers=left,
   numberstyle=\tiny, stepnumber=1,
    numbersep=5pt,language=python,label=L-gamelogicserverprotocol,caption=Game logic server's protocol of the state machine]
def myFirstAction(state, header, body):
    print ' [GameLogicServer] React to myFirstAction message'

def mySecondAction(state, header, body):
    print ' [GameLogicServer] React to mySecondAction message'

def myFourthAction(state, header, body):
    print ' [GameLogicServer] React to myFourthAction message'

def myFitfhAction(state, header, body):
    print ' [GameLogiceServer] React to myFitfhAction message'
\end{lstlisting}

\endinput
